# XHS-Downloader Skill 使用指南

## Skill 已成功安装！

**Skill 名称**: `xhs-downloader`
**安装位置**: `C:\Users\admin\.claude\skills\xhs-downloader\`

---

## 快速开始

### 方式1：通过对话使用（推荐）

直接告诉 Claude 你要下载的小红书链接：

```
用户：帮我下载这个小红书作品
https://www.xiaohongshu.com/discovery/item/6954ec6700000000220329a6
```

Claude 会自动：
1. 识别这是小红书链接
2. 调用 xhs-downloader skill
3. 下载所有无水印文件
4. 返回下载位置

### 方式2：使用示例脚本

```bash
# 基础下载
python "C:\Users\admin\.claude\skills\xhs-downloader\examples\quick_download.py" "https://www.xiaohongshu.com/discovery/item/xxx"

# 仅获取信息（不下载）
python "C:\Users\admin\.claude\skills\xhs-downloader\examples\quick_download.py" "https://www.xiaohongshu.com/discovery/item/xxx" --info-only

# 指定下载部分图片
python "C:\Users\admin\.claude\skills\xhs-downloader\examples\quick_download.py" "https://www.xiaohongshu.com/discovery/item/xxx" --index 1 3 5
```

---

## 支持的功能

### ✅ 基础下载
- 下载无水印图片（PNG 格式）
- 下载无水印视频
- 自动提取作品元数据

### ✅ 高级选项
- 仅获取作品信息（不下载文件）
- 指定下载部分图片（仅图文作品）
- 自定义文件命名格式

### ✅ 智能功能
- 自动跳过已下载作品
- 支持批量下载
- 下载记录持久化

---

## 支持的链接格式

- `https://www.xiaohongshu.com/explore/作品ID`
- `https://www.xiaohongshu.com/discovery/item/作品ID`
- `https://www.xiaohongshu.com/user/profile/作者ID/作品ID`
- `https://xhslink.com/分享码`

---

## 文件保存位置

**默认路径**：
```
C:\Users\admin\Projects\XHS-Downloader\Volume\Download\
```

**文件命名格式**：
```
发布时间_作者昵称_作品标题_序号.扩展名
例：2025-12-31_17.29.01_Ruuu_我的年度18张图_1.png
```

---

## 使用示例

### 示例1：下载单个作品

```
用户：下载这个小红书
https://www.xiaohongshu.com/discovery/item/6954ec6700000000220329a6

Claude：
✓ 开始处理...
✓ 提取作品信息：我的年度18张图
✓ 作者：Ruuu
✓ 下载 18 张图片
✓ 完成！文件已保存到：C:\Users\admin\Projects\XHS-Downloader\Volume\Download\
```

### 示例2：仅获取信息

```
用户：获取这个作品的信息，不要下载
https://www.xiaohongshu.com/explore/xxx

Claude：
✓ 标题：我的年度18张图
✓ 作者：Ruuu
✓ 发布时间：2025-12-31 17:29:01
✓ 点赞：1901  收藏：1543  评论：1239
✓ 标签：#旅行 #美食 #生活
✓ 作品类型：图文
```

### 示例3：指定下载部分图片

```
用户：只下载第1、3、5张图片
https://www.xiaohongshu.com/discovery/item/xxx

Claude：
✓ 开始下载...
✓ 下载第1张：..._1.png ✓
✓ 下载第3张：..._3.png ✓
✓ 下载第5张：..._5.png ✓
✓ 完成！
```

---

## 配置选项

### 修改下载位置

编辑配置文件：
```json
{
  "work_path": "C:\\Users\\admin\\XHS-Downloader\\Volume",
  "folder_name": "Download"
}
```

### 修改图片格式

支持格式：`PNG`、`WEBP`、`JPEG`、`HEIC`、`AUTO`

```json
{
  "image_format": "PNG"
}
```

### 自定义文件命名

支持字段：
- `发布时间`
- `作者昵称`
- `作品标题`
- `作品ID`
- `作品类型`
- `点赞数量`
- `收藏数量`
- `评论数量`
- `分享数量`
- `作品标签`

```json
{
  "name_format": "发布时间 作者昵称 作品标题"
}
```

---

## 常见问题

### Q1: 提示"无法导入 XHS 模块"

**原因**：XHS-Downloader 项目路径错误

**解决**：
1. 检查项目是否存在：`C:\Users\admin\Projects\XHS-Downloader`
2. 确认依赖已安装：`cd C:\Users\admin\Projects\XHS-Downloader && pip install -r requirements.txt`

### Q2: 下载速度慢

**原因**：内置请求延时机制，避免对平台服务器造成压力

**解决**：这是正常行为，耐心等待即可

### Q3: 文件已存在，不重新下载

**原因**：启用了下载记录功能

**解决**：
1. 删除 `C:\Users\admin\Projects\XHS-Downloader\Volume\ExploreID.db`
2. 或在配置文件中设置 `"download_record": false`

### Q4: 下载的图片有水印

**原因**：使用了错误的服务端

**解决**：确保使用 XHS-Downloader 的下载地址，不是小红书网页端的直链

---

## 技术细节

### 依赖项目

- **XHS-Downloader**: https://github.com/JoeanAmier/XHS-Downloader
- **Python**: 3.12+
- **httpx**: HTTP 客户端
- **lxml**: HTML 解析
- **asyncio**: 异步 IO

### 工作原理

1. **链接提取**：解析小红书链接，提取作品ID
2. **API请求**：通过小红书 API 获取作品数据
3. **数据解析**：解析 JSON 响应，提取下载地址
4. **文件下载**：异步下载所有文件
5. **记录保存**：将下载记录写入数据库

### 性能特点

- ✅ 异步下载，速度快
- ✅ 自动重试机制
- ✅ 断点续传支持
- ✅ 请求延时，避免封号

---

## 版本信息

- **Skill 版本**: 1.0.0
- **基于项目**: XHS-Downloader
- **创建日期**: 2026-01-23
- **最后更新**: 2026-01-23

---

## 后续优化方向

- [ ] 支持批量下载（多个链接）
- [ ] 支持作品搜索和批量提取
- [ ] 集成 MCP 服务器（实现无缝调用）
- [ ] 添加下载进度条
- [ ] 支持自定义下载路径

---

**祝使用愉快！** 🎉

如有问题，请查看 `README.md` 或 `SKILL.md` 获取更多详细信息。
