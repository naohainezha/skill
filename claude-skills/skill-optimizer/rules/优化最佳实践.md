# Skill 2.0 优化最佳实践

## 核心原则

### 原则一：轻量级总控（SKILL.md）

**目标**：将 SKILL.md 保持在 50-80 行

**实现方法**：
1. 只保留核心内容：概述、工作流索引、参考资料
2. 移出详细内容：代码示例、API 文档、配置说明
3. 使用表格展示：工作流索引、参考资料索引

**收益**：
- 上下文加载减少 50-70%
- 快速浏览和导航
- 主文档聚焦

---

### 原则二：显式工作流（workflow/）

**目标**：每个步骤独立文件，线性可执行

**文件命名**：`stepN-步骤名.md`（N 从 1 开始）

**文件结构**：
```markdown
# 第N步：步骤名

## 你的任务
[明确描述任务]

## 执行步骤
[具体步骤列表]

## 完成标志
[完成条件]

## 参考资源
- [引用相关文件]
```

**收益**：
- Claude 逐个步骤执行
- 清晰的完成标志
- 易于维护和调试

---

### 原则三：规则集中化（rules/）

**目标**：所有规则集中管理，易于查阅

**推荐文件**：
- `禁止清单.md`：绝对禁止的词汇和行为
- `写作规范.md`：语言风格、内容要求
- `字数要求.md`：严格的字数限制
- `配置说明.md`：参数详解、使用方法

**收益**：
- 规则检查时集中查阅
- 避免全文搜索
- 减少遗漏风险

---

### 原则四：参考资料独立（references/）

**目标**：详细文档按需加载，不占用主上下文

**推荐文件**：
- `API文档.md`：方法详解、参数说明
- `项目结构.md`：项目/工具的结构说明
- `示例.md`：详细使用示例
- `常见问题.md`：问题和解决方案

**收益**：
- 按需加载特定知识
- 主文档保持轻量
- 提升上下文效率

---

### 原则五：模板系统化（templates/）

**目标**：输出格式、脚本模板独立管理

**推荐文件**：
- `输出格式.md`：标准输出结构
- `配置模板.md`：配置文件示例

**收益**：
- 输出格式统一
- 模板易于复用
- 代码结构清晰

---

### 原则六：脚本可执行（scripts/）

**目标**：工具脚本独立，可直接执行

**推荐文件**：
- `脚本模板.py`：可执行的 Python 脚本
- `工具脚本.sh`：可执行的 Bash 脚本

**收益**：
- 脚本可直接执行
- 无需加载到上下文
- 代码复用性高

---

## 优化流程

### 阶段一：分析
1. 读取 SKILL.md，统计行数
2. 检查目录结构，识别现有模块
3. 识别问题类型：臃肿/工作流隐式/规则分散

### 阶段二：设计
1. 确定架构类型（工作流型/工具型/知识库型）
2. 设计目录结构
3. 规划文件清单

### 阶段三：创建
1. 创建所有目录
2. 编写新文件（workflow/rules/references/templates/scripts）
3. 拆分原始内容

### 阶段四：重写
1. 编写轻量级 SKILL.md（50-80 行）
2. 确保所有引用关系正确
3. 验证链接有效性

### 阶段五：验证
1. 验证文件结构完整性
2. 验证 SKILL.md 行数
3. 验证功能完整性
4. 生成验证报告

---

## 常见错误和解决方案

### 错误一：SKILL.md 仍然臃肿
**原因**：拆分不彻底，仍保留大量详细内容

**解决方案**：
- 检查 SKILL.md 行数
- 如果超过 80 行，继续拆分
- 移出所有代码示例、详细说明

### 错误二：工作流步骤不清晰
**原因**：步骤文件内容不够详细

**解决方案**：
- 每个 step 文件应包含：任务、步骤、完成标志、参考资源
- 避免过于简略
- 提供具体的执行指引

### 错误三：链接错误
**原因**：SKILL.md 中的链接路径不正确

**解决方案**：
- 使用相对路径：`[workflow/step1-xxx.md](workflow/step1-xxx.md)`
- 验证文件实际存在
- 检查文件名拼写

### 错误四：功能遗漏
**原因**：优化时删除了某些功能

**解决方案**：
- 对比优化前后功能
- 确保所有原始功能保留
- 如有功能缺失，需补充

---

## 成功标准

优化后的 skill 应满足：

- [ ] SKILL.md 行数 50-80 行
- [ ] 所有文件正确创建
- [ ] 链接关系正确建立
- [ ] 功能完整性验证通过
- [ ] 上下文效率提升 > 50%

达到这些标准，优化才算成功。
