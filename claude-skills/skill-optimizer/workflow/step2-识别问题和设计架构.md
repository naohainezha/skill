# 第二步：识别问题和设计架构

## 你的任务

基于第一步的分析结果，识别具体问题并设计优化后的新架构。

## 问题识别

### 常见问题模式

#### 1. 单文件臃肿
**症状**：
- SKILL.md 行数 > 100
- 包含大量代码示例（10-50 行）
- 嵌入详细文档（API 参考、配置说明）

**影响**：
- 每次触发加载全部内容
- 上下文窗口占用高
- 信息密度低

**解决方案**：拆分到 references/ 或 templates/

#### 2. 工作流隐式
**症状**：
- 步骤描述混在正文段落中
- 无明确的步骤清单
- 缺少"完成标志"

**影响**：
- Claude 需要记住所有步骤
- 容易遗漏或混乱

**解决方案**：创建 workflow/ 目录，每个步骤独立文件

#### 3. 规则分散
**症状**：
- 禁止词汇混在各处
- 字数要求分散在不同段落
- 缺少集中的 rules/ 目录

**影响**：
- 检查时需要全文搜索
- 容易遗漏某些规则

**解决方案**：创建 rules/ 目录，规则集中管理

#### 4. 参考资料内嵌
**症状**：
- 长篇示例、API 文档直接写在 SKILL.md
- 详细说明占用大量篇幅

**影响**：
- 主文档不聚焦
- 关键流程被淹没

**解决方案**：移到 references/ 目录，按需加载

## 架构设计原则

### 原则一：轻量级总控
- **SKILL.md 目标行数**：50-80 行
- **只包含**：元数据、工作流索引、快速开始
- **移出所有**：详细说明、代码示例、长篇示例

### 原则二：显式工作流
- **每个步骤独立文件**：workflow/stepN-步骤名.md
- **包含内容**：任务描述、执行指引、完成标志、参考资源
- **数量建议**：
  - 工作流型：5-8 个步骤
  - 工具型：3-5 个步骤
  - 知识库型：2-3 个步骤

### 原则三：规则集中化
- **rules/ 目录**：所有规则、要求、配置说明
- **文件分类**：
  - `禁止清单.md`：绝对禁止的词汇和行为
  - `写作规范.md`：语言风格和内容要求
  - `字数要求.md`：严格的字数限制
  - `配置说明.md`：配置参数详解

### 原则四：参考资料独立
- **references/ 目录**：详细文档、API 参考、示例
- **按需加载**：仅在需要时读取，不在 SKILL.md 中全部加载
- **内容分类**：
  - API 文档：方法详解、参数说明
  - 配置指南：详细配置说明
  - 示例集合：使用案例、输出格式

### 原则五：模板系统化
- **templates/ 目录**：输出格式、脚本模板
- **内容分类**：
  - 输出格式：标准输出结构
  - 脚本模板：可执行的代码模板

## 新架构设计

### 工作流型架构
```
skill-name/
├── SKILL.md (50-80行)      ← 轻量级总控
├── workflow/                 ← 显式工作流
│   ├── step1-阶段名.md
│   ├── step2-阶段名.md
│   └── ...
├── rules/                    ← 规则集中
│   ├── 禁止清单.md
│   ├── 写作规范.md
│   └── ...
├── references/                ← 详细参考资料
│   ├── API文档.md
│   ├── 示例.md
│   └── ...
├── templates/                ← 输出模板
│   ├── 输出格式.md
│   └── ...
└── scripts/                  ← 工具脚本（可选）
    ├── 工具脚本.py
    └── ...
```

### 工具型架构
```
skill-name/
├── SKILL.md (50-80行)
├── workflow/ (3-5个步骤)
├── rules/ (2-3个规则)
├── references/ (3-5个参考)
├── scripts/ (可选)
└── assets/ (可选)
```

## 完成标志

设计出完整的架构方案，包含：
- 目录结构图
- 文件清单（列出所有将要创建的文件）
- 预计的 SKILL.md 行数
- 预计的上下文减少比例

进入下一步创建目录结构。
